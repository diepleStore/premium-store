!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="8814420a-7612-4ae0-8106-e1f489ade219",e._sentryDebugIdIdentifier="sentry-dbid-8814420a-7612-4ae0-8106-e1f489ade219")}catch(e){}}(),(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6106,9919],{2468:(e,t,s)=>{"use strict";s.d(t,{e:()=>c});var a=s(63719),n=s(56947),r=s(68324),l=s(77570);let o=a.A.functions.list();async function i(e,t,s){let{projectRef:a,connectionString:n}=e,r=new Headers(s),{result:i}=await (0,l.E)({projectRef:a,connectionString:n,sql:o.sql,queryKey:["database-functions"]},t,r);return i}let c=function(e){let{projectRef:t,connectionString:s}=e,{enabled:a=!0,...l}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,n.I)(r.c.databaseFunctions(t),e=>{let{signal:a}=e;return i({projectRef:t,connectionString:s},a)},{enabled:a&&void 0!==t,...l})}},11375:(e,t,s)=>{"use strict";s.d(t,{d:()=>d});var a=s(80263),n=s(44893),r=s(79279),l=s(53239),o=s(2);let i=(0,r.F)("peer inline-flex shrink-0 cursor-pointer items-center rounded-full border transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-brand data-[state=checked]:hover:bg-brand-600/90 data-[state=unchecked]:bg-control data-[state=unchecked]:hover:bg-border",{variants:{size:{small:"h-[16px] w-[28px]",medium:"h-[20px] w-[34px]",large:"h-[24px] w-[44px]"}},defaultVariants:{size:"medium"}}),c=(0,r.F)("pointer-events-none block rounded-full bg-foreground-lighter data-[state=checked]:bg-white shadow-lg ring-0 transition-transform",{variants:{size:{small:"h-[12px] w-[12px] data-[state=checked]:translate-x-[13px] data-[state=unchecked]:translate-x-[1px]",medium:"h-[16px] w-[16px] data-[state=checked]:translate-x-[15px] data-[state=unchecked]:translate-x-[1px]",large:"h-[18px] w-[18px] data-[state=checked]:translate-x-[22px] data-[state=unchecked]:translate-x-[3px]"}},defaultVariants:{size:"medium"}}),d=l.forwardRef((e,t)=>{let{className:s,size:r,...l}=e;return(0,a.jsx)(n.bL,{className:(0,o.cn)(i({size:r}),s),...l,ref:t,children:(0,a.jsx)(n.zi,{className:(0,o.cn)(c({size:r}))})})});d.displayName=n.bL.displayName},12141:(e,t,s)=>{"use strict";s.d(t,{s:()=>c,v:()=>d});var a=s(80263),n=s(72342),r=s(53239),l=s(24922),o=s(27863),i=s(2);let c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.bL,{className:(0,i.cn)("flex flex-col -space-y-px w-full",s),...r,ref:t})});c.displayName="RadioGroupStacked";let d=r.forwardRef((e,t)=>{let{image:s,label:r,showIndicator:c=!0,...d}=e;return(0,a.jsx)(n.q7,{ref:t,...d,className:(0,i.cn)("flex flex-col gap-2","w-full","bg-overlay/50 disabled:opacity-50","border","first-of-type:rounded-t-lg last-of-type:rounded-b-lg","shadow-sm","enabled:hover:bg-surface-300","enabled:hover:border-foreground-muted","enabled:cursor-pointer disabled:cursor-not-allowed","hover:z-[1] focus-visible:z-[1]","data-[state=checked]:z-[1]","data-[state=checked]:ring-1 data-[state=checked]:ring-border","data-[state=checked]:bg-surface-300","data-[state=checked]:border-foreground-muted","transition","group",d.className),children:(0,a.jsxs)("div",{className:"flex gap-3 w-full px-[21px] py-3",children:[c&&(0,a.jsx)("div",{className:(0,i.cn)("aspect-square h-4 w-4 min-w-4 min-h-4","rounded-full border group-data-[state=checked]:border-foreground-muted","group-focus:border-foreground-muted","group-hover:border-foreground-muted","ring-offset-background","group-focus:outline-none","group-focus-visible:ring-2 group-focus-visible:ring-ring group-focus-visible:ring-offset-2","flex items-center justify-center","transition"),children:(0,a.jsx)(n.C1,{className:"flex items-center justify-center",children:(0,a.jsx)(l.A,{className:"h-2.5 w-2.5 fill-current text-current"})})}),(0,a.jsxs)("div",{className:"flex flex-col gap-0.25 items-start",children:[(0,a.jsx)(o.J,{htmlFor:d.value,className:(0,i.cn)("block","-mt-[0.15rem]","text-sm transition-colors text-left","text-light","group-hover:text-foreground group-data-[state=checked]:text-foreground"),children:r}),d.description&&(0,a.jsx)("p",{className:"text-sm text-foreground-lighter",children:d.description}),d.children]})]})})});d.displayName="RadioGroupStackedItem"},15629:(e,t,s)=>{"use strict";s.d(t,{GQ:()=>r,Il:()=>l});var a=s(97344),n=s.n(a);function r(e){let t=null==e?void 0:e.split(",").map(e=>e.trim());return n()(e)||!t||0===t.length?{value:[]}:{value:t.map(e=>{let t=e.match(/(\w+)\s+([\w\[\]]+)(?:\s+DEFAULT\s+(.*))?/i);if(!t)return console.error("Error while trying to parse function arguments",e),null;{let[,e,s,a]=t,n=a?a.trim():void 0;return["timestamp","time","timetz","timestamptz"].includes(s.toLowerCase())&&n&&(n="'".concat(n,"'")),{name:e,type:s,defaultValue:n}}}).filter(Boolean)}}function l(e){let t=[];if(e)for(var s in e)t.push({name:s,value:e[s]});return{value:t}}},21292:(e,t,s)=>{"use strict";s.d(t,{A:()=>y});var a=s(80263),n=s(60045),r=s(98667),l=s(64238),o=s(97318),i=s(53239),c=s(45969),d=s(15665),u=s(65904),h=s(16601),m=s(81250),f=s(98883),x=s(10738),p=s(50854),g=s(83405);let y=e=>{let{className:t,disabled:s=!1,size:y="tiny",showError:j=!0,selectedSchemaName:b,supportSelectAll:v=!1,excludedSchemas:N=[],onSelectSchema:w,onSelectCreateSchema:k}=e,[S,C]=(0,i.useState)(!1),A=(0,u.SE)(n.aG.TENANT_SQL_ADMIN_WRITE,"schemas"),{project:_}=(0,c.Om)(),{data:T,isLoading:E,isSuccess:R,isError:M,error:H,refetch:O}=(0,d.w$)({projectRef:null==_?void 0:_.ref,connectionString:null==_?void 0:_.connectionString}),I=(T||[]).filter(e=>!N.includes(e.name)).sort((e,t)=>e.name.localeCompare(t.name));return(0,a.jsxs)("div",{className:t,"data-sentry-component":"SchemaSelector","data-sentry-source-file":"SchemaSelector.tsx",children:[E&&(0,a.jsx)(h.$,{type:"default",className:"w-full [&>span]:w-full",size:y,disabled:!0,children:(0,a.jsx)(m.E,{className:"w-full h-3 bg-foreground-muted"})},"schema-selector-skeleton"),j&&M&&(0,a.jsxs)(f.Fc,{variant:"warning",className:"!px-3 !py-3",children:[(0,a.jsx)(f.XL,{className:"text-xs text-amber-900",children:"Failed to load schemas"}),(0,a.jsxs)(f.TN,{className:"text-xs mb-2 break-words",children:["Error: ",null==H?void 0:H.message]}),(0,a.jsx)(h.$,{type:"default",size:"tiny",onClick:()=>O(),children:"Reload schemas"})]}),R&&(0,a.jsxs)(x.AM,{open:S,onOpenChange:C,modal:!1,children:[(0,a.jsx)(x.Wv,{asChild:!0,children:(0,a.jsx)(h.$,{size:y,disabled:s,type:"default","data-testid":"schema-selector",className:"w-full [&>span]:w-full !pr-1 space-x-1",iconRight:(0,a.jsx)(r.A,{className:"text-foreground-muted",strokeWidth:2,size:14}),children:b?(0,a.jsxs)("div",{className:"w-full flex gap-1",children:[(0,a.jsx)("p",{className:"text-foreground-lighter",children:"schema"}),(0,a.jsx)("p",{className:"text-foreground",children:"*"===b?"All schemas":b})]}):(0,a.jsx)("div",{className:"w-full flex gap-1",children:(0,a.jsx)("p",{className:"text-foreground-lighter",children:"Choose a schemaâ€¦"})})})}),(0,a.jsx)(x.hl,{className:"p-0 min-w-[200px] pointer-events-auto",side:"bottom",align:"start",portal:!0,sameWidthAsTrigger:!0,children:(0,a.jsxs)(p.uB,{children:[(0,a.jsx)(p.G7,{placeholder:"Find schema..."}),(0,a.jsxs)(p.oI,{children:[(0,a.jsx)(p.xL,{children:"No schemas found"}),(0,a.jsx)(p.L$,{children:(0,a.jsxs)(g.FK,{className:(I||[]).length>7?"h-[210px]":"",children:[v&&(0,a.jsxs)(p.h_,{className:"cursor-pointer flex items-center justify-between space-x-2 w-full",onSelect:()=>{w("*"),C(!1)},onClick:()=>{w("*"),C(!1)},children:[(0,a.jsx)("span",{children:"All schemas"}),"*"===b&&(0,a.jsx)(l.A,{className:"text-brand",strokeWidth:2,size:16})]},"select-all"),null==I?void 0:I.map(e=>(0,a.jsxs)(p.h_,{className:"cursor-pointer flex items-center justify-between space-x-2 w-full",onSelect:()=>{w(e.name),C(!1)},onClick:()=>{w(e.name),C(!1)},children:[(0,a.jsx)("span",{children:e.name}),b===e.name&&(0,a.jsx)(l.A,{className:"text-brand",strokeWidth:2,size:16})]},e.id))]})}),void 0!==k&&A&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(p.fx,{}),(0,a.jsx)(p.L$,{children:(0,a.jsxs)(p.h_,{className:"cursor-pointer flex items-center gap-x-2 w-full",onSelect:()=>{k(),C(!1)},onClick:()=>{k(),C(!1)},children:[(0,a.jsx)(o.A,{size:12}),"Create a new schema"]})})]})]})]})})]})]})}},30013:(e,t,s)=>{"use strict";s.d(t,{A:()=>v});var a=s(80263),n=s(86727),r=s.n(n),l=s(98667),o=s(64238),i=s(97318),c=s(53239),d=s(45969),u=s(2468),h=s(16601),m=s(98883),f=s(10738),x=s(50854),p=s(83405),g=s(52385),y=s(63320),j=s.n(y),b=s(89044);let v=e=>{let{className:t,size:s="tiny",showError:n=!0,disabled:y=!1,schema:v,value:N,onChange:w,filterFunction:k=()=>!0,noResultsLabel:S=(0,a.jsx)("span",{children:"No functions found in this schema."})}=e,C=(0,g.useRouter)(),{ref:A}=(0,b.g)(),{project:_}=(0,d.Om)(),[T,E]=(0,c.useState)(!1),{data:R,error:M,isLoading:H,isError:O,isSuccess:I,refetch:K}=(0,u.e)({projectRef:null==_?void 0:_.ref,connectionString:null==_?void 0:_.connectionString}),L=(null!=R?R:[]).filter(e=>v&&e.schema===v).filter(k),V=r()(L,e=>e.name);return(0,a.jsxs)("div",{className:t,"data-sentry-component":"FunctionSelector","data-sentry-source-file":"FunctionSelector.tsx",children:[H&&(0,a.jsx)(h.$,{type:"default",className:"justify-start",block:!0,size:s,loading:!0,children:"Loading functions..."}),n&&O&&(0,a.jsxs)(m.Fc,{variant:"warning",className:"!px-3 !py-3",children:[(0,a.jsx)(m.XL,{className:"text-xs text-amber-900",children:"Failed to load functions"}),(0,a.jsxs)(m.TN,{className:"text-xs mb-2",children:["Error: ",M.message]}),(0,a.jsx)(h.$,{type:"default",size:"tiny",onClick:()=>K(),children:"Reload functions"})]}),I&&(0,a.jsxs)(f.AM,{open:T,onOpenChange:E,modal:!1,children:[(0,a.jsx)(f.Wv,{asChild:!0,children:(0,a.jsx)(h.$,{size:s,disabled:!!y,type:"default",className:"w-full [&>span]:w-full ".concat("small"===s?"py-1.5":""),iconRight:(0,a.jsx)(l.A,{className:"text-foreground-muted",strokeWidth:2,size:14}),children:N?(0,a.jsxs)("div",{className:"w-full flex gap-1",children:[(0,a.jsx)("p",{className:"text-foreground-lighter",children:"function:"}),(0,a.jsx)("p",{className:"text-foreground",children:N})]}):(0,a.jsx)("div",{className:"w-full flex gap-1",children:(0,a.jsx)("p",{className:"text-foreground-lighter",children:"Select a function"})})})}),(0,a.jsx)(f.hl,{className:"p-0",side:"bottom",align:"start",sameWidthAsTrigger:!0,children:(0,a.jsxs)(x.uB,{children:[(0,a.jsx)(x.G7,{placeholder:"Search functions..."}),(0,a.jsxs)(x.oI,{children:[(0,a.jsx)(x.xL,{children:"No functions found"}),(0,a.jsx)(x.L$,{children:(0,a.jsxs)(p.FK,{className:(V||[]).length>7?"h-[210px]":"",children:[!V.length&&(0,a.jsx)(x.h_,{disabled:!0,className:"flex items-center justify-between space-x-2 w-full",children:S},"no-function-found"),V.map(e=>(0,a.jsxs)(x.h_,{value:e.name.replaceAll('"',""),className:"cursor-pointer flex items-center justify-between space-x-2 w-full",onSelect:()=>{w(e.name),E(!1)},onClick:()=>{w(e.name),E(!1)},children:[(0,a.jsx)("span",{children:e.name}),N===e.name&&(0,a.jsx)(o.A,{className:"text-brand",size:14,strokeWidth:2})]},e.id))]})}),(0,a.jsx)(x.fx,{}),(0,a.jsx)(x.L$,{children:(0,a.jsx)(x.h_,{className:"cursor-pointer w-full",onSelect:()=>{E(!1),C.push("/project/".concat(A,"/database/functions"))},onClick:()=>E(!1),children:(0,a.jsxs)(j(),{href:"/project/".concat(A,"/database/functions"),onClick:()=>{E(!1)},className:"w-full flex items-center gap-2",children:[(0,a.jsx)(i.A,{size:14,strokeWidth:1.5}),(0,a.jsx)("p",{children:"New function"})]})})})]})]})})]})]})}},31727:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(47370).A)("Webhook",[["path",{d:"M18 16.98h-5.99c-1.1 0-1.95.94-2.48 1.9A4 4 0 0 1 2 17c.01-.7.2-1.4.57-2",key:"q3hayz"}],["path",{d:"m6 17 3.13-5.78c.53-.97.1-2.18-.5-3.1a4 4 0 1 1 6.89-4.06",key:"1go1hn"}],["path",{d:"m12 6 3.13 5.73C15.66 12.7 16.9 13 18 13a4 4 0 0 1 0 8",key:"qlwsc0"}]])},39551:(e,t,s)=>{"use strict";var a=s(23727),n=s(93226).Buffer,r=s.g.crypto||s.g.msCrypto;r&&r.getRandomValues?e.exports=function(e,t){if(e>0xffffffff)throw RangeError("requested too many random bytes");var s=n.allocUnsafe(e);if(e>0)if(e>65536)for(var l=0;l<e;l+=65536)r.getRandomValues(s.slice(l,l+65536));else r.getRandomValues(s);return"function"==typeof t?a.nextTick(function(){t(null,s)}):s}:e.exports=function(){throw Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11")}},42190:(e,t,s)=>{"use strict";s.d(t,{A:()=>c});var a=s(80263),n=s(63320),r=s.n(n),l=s(42677),o=s(38952),i=s(16601);let c=e=>{let{name:t="",isActive:s,isExternal:n,icon:c,rightIcon:d,url:u="",target:h="_self",onClick:m,textClassName:f="",hoverText:x="",label:p}=e,g=(0,a.jsx)(l.Ay.Item,{icon:c,rounded:!0,active:s,onClick:m,children:(0,a.jsxs)("div",{className:"flex w-full items-center justify-between gap-1",children:[(0,a.jsxs)("div",{title:x||("string"==typeof t?t:""),className:"flex items-center gap-2 truncate w-full "+f,children:[(0,a.jsxs)("span",{className:"truncate",children:[t," "]}),void 0!==p&&(0,a.jsx)(o.E,{variant:"warning",className:"py-0 px-1.5 capitalize",children:p})]}),d&&(0,a.jsx)("div",{children:d})]})});return u?n?(0,a.jsx)(i.$,{asChild:!0,block:!0,className:"!justify-start",type:"text",size:"small",icon:c,children:(0,a.jsx)(r(),{href:u,target:"_blank",rel:"noreferrer",children:t})}):(0,a.jsx)(r(),{href:u,className:"block",target:h,children:g}):g}},42677:(e,t,s)=>{"use strict";s.d(t,{Ay:()=>h});var a=s(80263),n=s(53239),r=s(77690),l=s(2);function o(e){let{children:t,className:s,tag:n="div",style:r}=e;return(0,a.jsx)("".concat(n),{style:r,"data-sentry-element":"CustomTag","data-sentry-component":"Typography","data-sentry-source-file":"Typography.tsx",children:t})}o.Title=function(e){let{className:t,level:s=1,children:n,style:r}=e;return(0,a.jsx)("h".concat(s),{style:r,"data-sentry-element":"CustomTag","data-sentry-component":"Title","data-sentry-source-file":"Title.tsx",children:n})},o.Text=function(e){let{className:t,children:s,style:n,type:r,disabled:l,mark:o,code:i,keyboard:c,underline:d,strikethrough:u,strong:h,small:m}=e;return i?(0,a.jsx)("code",{style:n,children:s}):o?(0,a.jsx)("mark",{style:n,children:s}):c?(0,a.jsx)("kbd",{style:n,children:s}):h?(0,a.jsx)("strong",{style:n,children:s}):(0,a.jsx)("span",{style:n,"data-sentry-component":"Text","data-sentry-source-file":"Text.tsx",children:s})},o.Link=function(e){let{children:t,target:s="_blank",href:n,className:r,onClick:l,style:o}=e;return(0,a.jsx)("a",{onClick:l,href:n,target:s,rel:"noopener noreferrer",style:o,"data-sentry-component":"Link","data-sentry-source-file":"Link.tsx",children:t})};let i=(0,n.createContext)({type:"text"}),c=e=>{let{type:t}=e;return(0,a.jsx)(i.Provider,{value:{type:t},"data-sentry-element":"unknown","data-sentry-component":"MenuContextProvider","data-sentry-source-file":"MenuContext.tsx",children:e.children})},d=()=>{let e=(0,n.useContext)(i);if(void 0===e)throw Error("MenuContext must be used within a MenuContextProvider.");return e};function u(e){let{children:t,className:s,ulClassName:n,style:r,type:l="text"}=e;return(0,a.jsx)("nav",{role:"menu","aria-label":"Sidebar","aria-orientation":"vertical","aria-labelledby":"options-menu",className:s,style:r,"data-sentry-component":"Menu","data-sentry-source-file":"Menu.tsx",children:(0,a.jsx)(c,{type:l,"data-sentry-element":"MenuContextProvider","data-sentry-source-file":"Menu.tsx",children:(0,a.jsx)("ul",{className:n,children:t})})})}u.Item=function(e){let{children:t,icon:s,active:n,rounded:o,onClick:i,doNotCloseOverlay:c=!1,showActiveBar:u=!1,style:h}=e,m=(0,r.A)("menu"),{type:f}=d(),x=[m.item.base];x.push(m.item.variants[f].base),n?x.push(m.item.variants[f].active):x.push(m.item.variants[f].normal);let p=[m.item.content.base];n?p.push(m.item.content.active):p.push(m.item.content.normal);let g=[m.item.icon.base];return n?g.push(m.item.icon.active):g.push(m.item.icon.normal),(0,a.jsxs)("li",{role:"menuitem",className:(0,l.cn)("outline-none",x),style:h,onClick:i,"aria-current":n?"page":void 0,"data-sentry-component":"Item","data-sentry-source-file":"Menu.tsx",children:[s&&(0,a.jsx)("div",{className:"".concat(g.join(" ")," min-w-fit"),children:s}),(0,a.jsx)("span",{className:p.join(" "),children:t})]})},u.Group=function(e){let{children:t,icon:s,title:n}=e,l=(0,r.A)("menu"),{type:o}=d();return(0,a.jsxs)("div",{className:[l.group.base,l.group.variants[o]].join(" "),"data-sentry-component":"Group","data-sentry-source-file":"Menu.tsx",children:[s&&(0,a.jsx)("span",{className:l.group.icon,children:s}),(0,a.jsx)("span",{className:l.group.content,children:n}),t]})},u.Misc=function(e){let{children:t}=e;return(0,a.jsx)("div",{"data-sentry-component":"Misc","data-sentry-source-file":"Menu.tsx",children:(0,a.jsx)(o.Text,{"data-sentry-element":"unknown","data-sentry-source-file":"Menu.tsx",children:(0,a.jsx)("span",{children:t})})})};let h=u},47028:(e,t,s)=>{"use strict";s.d(t,{A:()=>g});var a=s(80263),n=s(63320),r=s.n(n),l=s(52385),o=s(89044),i=s(22775),c=s(67144),d=s(86137),u=s(29730),h=s(98883),m=s(16601),f=s(88601),x=s(64508);let p=()=>{let e=(0,l.useRouter)(),{ref:t="default"}=(0,o.g)(),s=(0,i.p4)();(0,d.$E)({projectRef:t});let n=e.pathname.split("/")[4];return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c.l,{page:n,menu:(0,x.B)(t),"data-sentry-element":"ProductMenu","data-sentry-source-file":"AuthLayout.tsx"}),s&&(0,a.jsx)("div",{className:"px-3",children:(0,a.jsxs)(h.Fc,{children:[(0,a.jsx)(h.XL,{className:"text-sm",children:"Column Privileges has been shifted"}),(0,a.jsxs)(h.TN,{className:"text-xs",children:[(0,a.jsx)("p",{className:"mb-2",children:"It can now be found in the menu under the database section."}),(0,a.jsx)(m.$,{asChild:!0,type:"default",size:"tiny",children:(0,a.jsx)(r(),{href:"/project/".concat(t,"/database/column-privileges"),children:"Head over to Database"})})]})]})})]})},g=(0,u.r)(e=>{let{children:t}=e;return(0,a.jsx)(f.A,{title:"Authentication",product:"Authentication",productMenu:(0,a.jsx)(p,{}),isBlocking:!1,"data-sentry-element":"ProjectLayout","data-sentry-component":"AuthLayout","data-sentry-source-file":"AuthLayout.tsx",children:t})})},60479:(e,t,s)=>{"use strict";s.d(t,{M:()=>w});var a=s(80263),n=s(63320),r=s.n(n),l=s(52385),o=s(89044),i=s(2),c=s(99673),d=s(16601),u=s(95207),h=s(48277),m=s(53239),f=s(38694),x=s(28894);let p=m.forwardRef((e,t)=>{let{...s}=e;return(0,a.jsx)("nav",{ref:t,"aria-label":"breadcrumb",...s})});p.displayName="Breadcrumb";let g=m.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("ol",{ref:t,className:(0,i.cn)("flex flex-wrap items-center gap-0.5 break-words text-sm text-muted-foreground sm:gap-1.5",s),...n})});g.displayName="BreadcrumbList";let y=m.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("li",{ref:t,className:(0,i.cn)("inline-flex text-foreground-lighter items-center gap-1.5 leading-5",s),...n})});y.displayName="BreadcrumbItem";let j=m.forwardRef((e,t)=>{let{asChild:s,className:n,...r}=e,l=s?f.DX:"a";return(0,a.jsx)(l,{ref:t,className:(0,i.cn)("transition-colors underline lg:no-underline hover:text-foreground",n),...r})});j.displayName="BreadcrumbLink";let b=m.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("span",{ref:t,role:"link","aria-disabled":"true","aria-current":"page",className:(0,i.cn)("no-underline text-foreground",s),...n})});b.displayName="BreadcrumbPage";let v=e=>{let{children:t,className:s,...n}=e;return(0,a.jsx)("li",{role:"presentation","aria-hidden":"true",className:(0,i.cn)("[&>svg]:size-3.5",s),...n,"data-sentry-component":"BreadcrumbSeparator","data-sentry-source-file":"breadcrumb.tsx",children:null!=t?t:(0,a.jsx)(x.A,{})})};v.displayName="BreadcrumbSeparator";let N=e=>{let{title:t,subtitle:s,icon:n,breadcrumbs:l=[],primaryActions:c,secondaryActions:d,className:f,isCompact:x=!1}=e,{ref:N}=(0,o.g)(),w=x&&t?[...l,{label:t}]:l;return(0,a.jsxs)("div",{className:(0,i.cn)("space-y-4",f),"data-sentry-component":"PageHeader","data-sentry-source-file":"PageHeader.tsx",children:[(w.length>0||x&&(t||c||d))&&(0,a.jsxs)("div",{className:(0,i.cn)("flex items-center gap-4",x?"justify-between":"mb-4"),children:[(0,a.jsx)("div",{className:"flex items-center gap-4",children:l.length>0?(0,a.jsx)(p,{className:(0,i.cn)("text-foreground-muted",x&&"text-base"),children:(0,a.jsxs)(g,{className:x?"text-base":"text-xs",children:[l.map((e,t)=>(0,a.jsxs)(m.Fragment,{children:[(0,a.jsx)(y,{children:e.element?e.element:e.href?(0,a.jsx)(j,{asChild:!0,className:"flex items-center gap-2",children:(0,a.jsxs)(r(),{href:N?e.href.replace("[ref]",N):e.href,children:[1===l.length&&!x&&(0,a.jsx)(h.A,{size:16,strokeWidth:1.5}),e.label]})}):(0,a.jsxs)(b,{className:"flex items-center gap-2",children:[1===l.length&&(0,a.jsx)(h.A,{size:16,strokeWidth:1.5}),e.label]})}),t<l.length-1&&(0,a.jsx)(v,{})]},e.label||"breadcrumb-".concat(t))),x&&t&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(v,{}),(0,a.jsx)(y,{children:(0,a.jsx)(b,{children:t})})]})]})}):x?t:null}),x&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[d&&(0,a.jsx)("div",{className:"flex items-center gap-2",children:d}),c&&(0,a.jsx)("div",{className:"flex items-center gap-2",children:c})]})]}),!x&&(0,a.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[n&&(0,a.jsx)("div",{className:"text-foreground-light",children:n}),(0,a.jsxs)("div",{className:"space-y-1",children:[t&&(0,a.jsx)(u.Dm,{children:t}),s&&(0,a.jsx)(u.dX,{className:"text-sm text-foreground-light",children:s})]})]})}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[d&&(0,a.jsx)("div",{className:"flex items-center gap-2",children:d}),c&&(0,a.jsx)("div",{className:"flex items-center gap-2",children:c})]})]})]})},w=e=>{let{children:t,title:s,subtitle:n,icon:h,breadcrumbs:m=[],primaryActions:f,secondaryActions:x,navigationItems:p=[],className:g,size:y="default",isCompact:j=!1}=e,{ref:b}=(0,o.g)(),v=(0,l.useRouter)();return(0,a.jsxs)("div",{className:"w-full min-h-full flex flex-col items-stretch","data-sentry-component":"PageLayout","data-sentry-source-file":"PageLayout.tsx",children:[(0,a.jsxs)(u.eh,{size:y,className:(0,i.cn)("w-full mx-auto","full"===y&&(j?"max-w-none !px-6 border-b":"max-w-none p!x-8 border-b"),j?"pt-4":"pt-12",0===p.length&&"full"===y&&(j?"pb-4":"pb-8"),g),"data-sentry-element":"ScaffoldContainer","data-sentry-source-file":"PageLayout.tsx",children:[(s||n||f||x||m.length>0)&&(0,a.jsx)(N,{title:s,subtitle:n,icon:h,breadcrumbs:m,primaryActions:f,secondaryActions:x,isCompact:j}),p.length>0&&(0,a.jsx)(c.h,{className:(0,i.cn)(j?"mt-2":"mt-4","full"===y&&"border-none"),children:p.map(e=>(0,a.jsx)(c.O,{active:v.asPath.split("?")[0]===e.href,children:e.href?(0,a.jsxs)(r(),{href:e.href.includes("[ref]")&&b?e.href.replace("[ref]",b):e.href,className:(0,i.cn)("inline-flex items-center gap-2",v.asPath===e.href&&"text-foreground"),onClick:e.onClick,children:[e.icon&&(0,a.jsx)("span",{children:e.icon}),e.label]}):(0,a.jsxs)(d.$,{type:"link",onClick:e.onClick,className:(0,i.cn)(v.pathname===e.href&&"text-foreground font-medium"),children:[e.icon&&(0,a.jsx)("span",{className:"mr-2",children:e.icon}),e.label]})},e.label))})]}),t]})}},60740:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[ref]/auth/hooks",function(){return s(74939)}])},67144:(e,t,s)=>{"use strict";s.d(t,{l:()=>o});var a=s(80263),n=s(42677),r=s(38952),l=s(42190);let o=e=>{let{page:t,menu:s}=e;return(0,a.jsx)("div",{className:"flex flex-col space-y-8 overflow-y-auto","data-sentry-component":"ProductMenu","data-sentry-source-file":"ProductMenu.tsx",children:(0,a.jsx)(n.Ay,{type:"pills","data-sentry-element":"Menu","data-sentry-source-file":"ProductMenu.tsx",children:s.map((e,o)=>(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"my-6 space-y-8",children:(0,a.jsxs)("div",{className:"mx-3",children:[(0,a.jsx)(n.Ay.Group,{title:e.title?(0,a.jsxs)("div",{className:"flex flex-col space-y-2 uppercase font-mono",children:[(0,a.jsx)("span",{children:e.title}),e.isPreview&&(0,a.jsx)(r.E,{variant:"warning",children:"Not production ready"})]}):null}),(0,a.jsx)("div",{children:e.items.map(e=>{let s=e.pages?e.pages.includes(null!=t?t:""):t===e.key;return(0,a.jsx)(l.A,{url:e.url,name:e.name,icon:e.icon,rightIcon:e.rightIcon,isActive:s,isExternal:e.isExternal,target:e.isExternal?"_blank":"_self",label:e.label},e.key)})})]})}),o!==s.length-1&&(0,a.jsx)("div",{className:"h-px w-full bg-border-overlay"})]},e.key||e.title))})})}},74939:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>ec});var a=s(80263),n=s(60045),r=s(53239),l=s(73969),o=s(89044),i=s(45969),c=s(95207),d=s(98474),u=s(70967),h=s(86137),m=s(32144),f=s(80251),x=s(3807),p=s(67849);async function g(e){let{projectRef:t,config:s}=e,{data:a,error:n}=await (0,x.F6)("/platform/auth/{ref}/config/hooks",{params:{path:{ref:t}},body:s});return n&&(0,x.H4)(n),a}let y=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,m.jE)();return(0,f.n)(e=>g(e),{async onSuccess(t,s,n){let{projectRef:r}=s;await a.invalidateQueries(p.Z.authConfig(r)),await (null==e?void 0:e(t,s,n))},async onError(e,s,a){void 0===t?l.oR.error("Failed to update auth hooks: ".concat(e.message)):t(e,s,a)},...s})};var j=s(77570),b=s(2),v=s(36212),N=s(68656),w=s(79319),k=s(65904),S=s(25718),C=s(33656),A=s(16601);let _=[{title:"Send SMS hook",subtitle:"Will be called by Supabase Auth each time an SMS message needs to be sent.",enabledKey:"HOOK_SEND_SMS_ENABLED",uriKey:"HOOK_SEND_SMS_URI",secretsKey:"HOOK_SEND_SMS_SECRETS",enterprise:!1},{title:"Send Email hook",subtitle:"Will be called by Supabase Auth each time an email message needs to be sent.",enabledKey:"HOOK_SEND_EMAIL_ENABLED",uriKey:"HOOK_SEND_EMAIL_URI",secretsKey:"HOOK_SEND_EMAIL_SECRETS",enterprise:!1},{title:"Customize Access Token (JWT) Claims hook",subtitle:"Will be called by Supabase Auth each time a new JWT is created. It should return the claims you wish to be present in the JWT.",enabledKey:"HOOK_CUSTOM_ACCESS_TOKEN_ENABLED",uriKey:"HOOK_CUSTOM_ACCESS_TOKEN_URI",secretsKey:"HOOK_CUSTOM_ACCESS_TOKEN_SECRETS",enterprise:!1},{title:"MFA Verification Attempt hook",subtitle:"Will be called by Supabase Auth each time a user tries to verify an MFA factor. Return a decision on whether to reject the attempt and future ones, or to allow the user to keep trying.",enabledKey:"HOOK_MFA_VERIFICATION_ATTEMPT_ENABLED",uriKey:"HOOK_MFA_VERIFICATION_ATTEMPT_URI",secretsKey:"HOOK_MFA_VERIFICATION_ATTEMPT_SECRETS",enterprise:!0},{title:"Password Verification Attempt hook",subtitle:"Will be called by Supabase Auth each time a user tries to sign in with a password. Return a decision whether to allow the user to reject the attempt, or to allow the user to keep trying.",enabledKey:"HOOK_PASSWORD_VERIFICATION_ATTEMPT_ENABLED",uriKey:"HOOK_PASSWORD_VERIFICATION_ATTEMPT_URI",secretsKey:"HOOK_PASSWORD_VERIFICATION_ATTEMPT_SECRETS",enterprise:!0}];var T=s(89426);let E=e=>{var t;let{buttonText:s="Add hook",align:r="end",onSelectHook:l}=e,{ref:i}=(0,o.g)(),c=(0,S.a)(),{data:d}=(0,h.op)({projectRef:i}),u=(0,k.SE)(n.aG.AUTH_EXECUTE,"*"),m=_.map(e=>({...e,enabled:(null==d?void 0:d[e.enabledKey])||!1,method:(0,T.vw)((null==d?void 0:d[e.uriKey])||"",(null==d?void 0:d[e.secretsKey])||"")})),f=m.filter(e=>!(0,T.U2)(e)&&!e.enterprise),x=m.filter(e=>!(0,T.U2)(e)&&e.enterprise),p=(null==c?void 0:c.plan.id)==="team"||(null==c?void 0:c.plan.id)==="enterprise";return u?(0,a.jsxs)(C.rI,{"data-sentry-element":"DropdownMenu","data-sentry-component":"AddHookDropdown","data-sentry-source-file":"AddHookDropdown.tsx",children:[(0,a.jsx)(C.ty,{asChild:!0,"data-sentry-element":"DropdownMenuTrigger","data-sentry-source-file":"AddHookDropdown.tsx",children:(0,a.jsx)(A.$,{type:"primary",iconRight:(0,a.jsx)(N.A,{className:"w-4 h-4",strokeWidth:1}),"data-sentry-element":"Button","data-sentry-source-file":"AddHookDropdown.tsx",children:s})}),(0,a.jsxs)(C.SQ,{className:"w-76",align:r,"data-sentry-element":"DropdownMenuContent","data-sentry-source-file":"AddHookDropdown.tsx",children:[(0,a.jsx)("div",{children:f.map(e=>(0,a.jsx)(C._2,{onClick:()=>l(e.title),children:e.title},e.title))}),(0,a.jsx)(C.mB,{"data-sentry-element":"DropdownMenuSeparator","data-sentry-source-file":"AddHookDropdown.tsx"}),!p&&(0,a.jsxs)(C.lp,{className:"grid gap-1 bg-surface-200",children:[(0,a.jsx)("p",{className:"text-foreground-light",children:"Team or Enterprise Plan required"}),(0,a.jsxs)("p",{className:"text-foreground-lighter text-xs",children:["The following hooks are not available on"," ",(0,a.jsx)("a",{target:"_href",href:"https://supabase.com/dashboard/org/".concat(null!=(t=null==c?void 0:c.slug)?t:"_","/billing"),className:"underline",children:"your plan"}),"."]})]}),x.map(e=>p?(0,a.jsx)(C._2,{disabled:!p,className:"",onClick:()=>l(e.title),children:e.title},e.title):(0,a.jsx)(C._2,{disabled:!p,onClick:()=>l(e.title),children:e.title},e.title))]})]}):(0,a.jsx)(w.G,{disabled:!0,type:"primary",tooltip:{content:{side:"bottom",text:"You need additional permissions to add auth hooks"}},children:s})};var R=s(32981),M=s(23278),H=s(39551),O=s.n(H),I=s(87494),K=s(86953),L=s(39353),V=s(15629),P=s(30013),z=s(21292),D=s(76828),F=s(16580),B=s(85669),W=s(11375),U=s(12141),$=s(49189),q=s(27787);let G="create-edit-auth-hook",J=L.Ik({hookType:L.Yj(),enabled:L.zM(),selectedType:L.KC([L.eu("https"),L.eu("postgres")]),httpsValues:L.Ik({url:L.Yj(),secret:L.Yj()}),postgresValues:L.Ik({schema:L.Yj(),functionName:L.Yj()})}).superRefine((e,t)=>("https"===e.selectedType&&(e.httpsValues.url.startsWith("https://")||t.addIssue({path:["httpsValues","url"],code:L.eq.custom,message:"The URL must start with https://"}),e.httpsValues.secret||t.addIssue({path:["httpsValues","secret"],code:L.eq.custom,message:"Missing secret value"})),"postgres"===e.selectedType&&(e.postgresValues.schema||t.addIssue({path:["postgresValues","schema"],code:L.eq.custom,message:"You must select a schema"}),e.postgresValues.functionName||t.addIssue({path:["postgresValues","functionName"],code:L.eq.custom,message:"You must select a Postgres function"})),!0)),X=e=>{let{visible:t,title:s,authConfig:n,onClose:c,onDelete:d}=e,{ref:h}=(0,o.g)(),{project:m}=(0,i.Om)(),f=(0,r.useMemo)(()=>_.find(e=>e.title===s)||_[0],[s]),x="HOOK_SEND_EMAIL_ENABLED"===f.enabledKey?["json","jsonb","void"]:["json","jsonb"],p=(0,r.useMemo)(()=>({...f,enabled:(null==n?void 0:n[f.enabledKey])||!1,method:(0,T.vw)((null==n?void 0:n[f.uriKey])||"",(null==n?void 0:n[f.secretsKey])||"")}),[f,n]),g=!(0,T.U2)(p),v=(0,I.mN)({resolver:(0,R.u)(J),defaultValues:{hookType:s||"",enabled:!0,selectedType:"postgres",httpsValues:{url:"",secret:""},postgresValues:{schema:"public",functionName:""}}}),N=v.watch(),w=(0,r.useMemo)(()=>{let e=[];return"postgres"===p.method.type&&""!==p.method.schema&&""!==p.method.functionName&&p.method.functionName!==N.postgresValues.functionName&&(e=(0,T.IT)(p.method.schema,p.method.functionName)),""!==N.postgresValues.functionName&&(e=[...e,"-- Grant access to function to supabase_auth_admin\ngrant execute on function ".concat(N.postgresValues.schema,".").concat(N.postgresValues.functionName," to supabase_auth_admin;"),"-- Grant access to schema to supabase_auth_admin\ngrant usage on schema ".concat(N.postgresValues.schema," to supabase_auth_admin;"),"-- Revoke function permissions from authenticated, anon and public\nrevoke execute on function ".concat(N.postgresValues.schema,".").concat(N.postgresValues.functionName," from authenticated, anon, public;")]),e},[p,N.postgresValues.schema,N.postgresValues.functionName]),{mutate:k,isLoading:S}=y({onSuccess:()=>{l.oR.success("Successfully created ".concat(N.hookType,".")),w.length>0&&(0,j.E)({projectRef:h,connectionString:m.connectionString,sql:w.join("\n")}),c()},onError:e=>{l.oR.error("Failed to create hook: ".concat(e.message))}}),C=async e=>{if(!m)return console.error("Project is required");let t=_.find(t=>e.hookType===t.title);if(!t)return;let s=t.enabledKey,a=t.uriKey,n=t.secretsKey,r="";r="postgres"===e.selectedType?"pg-functions://postgres/".concat(e.postgresValues.schema,"/").concat(e.postgresValues.functionName):e.httpsValues.url,k({projectRef:h,config:{[s]:e.enabled,[a]:r,[n]:"https"===e.selectedType?e.httpsValues.secret:null}})};return(0,r.useEffect)(()=>{if(t)if(f){let e=(0,T.vw)((null==n?void 0:n[f.uriKey])||"",(null==n?void 0:n[f.secretsKey])||"");v.reset({hookType:f.title,enabled:(null==n?void 0:n[f.enabledKey])||!1,selectedType:e.type,httpsValues:{url:"https"===e.type&&e.url||"",secret:"https"===e.type&&e.secret||""},postgresValues:{schema:"postgres"===e.type&&e.schema||"public",functionName:"postgres"===e.type&&e.functionName||""}})}else v.reset({hookType:s||"",enabled:!0,selectedType:"postgres",httpsValues:{url:"",secret:""},postgresValues:{schema:"public",functionName:""}})},[n,s,t,f]),(0,a.jsx)(D.cj,{open:t,onOpenChange:()=>c(),"data-sentry-element":"Sheet","data-sentry-component":"CreateHookSheet","data-sentry-source-file":"CreateHookSheet.tsx",children:(0,a.jsxs)(D.h,{size:"lg",showClose:!1,className:"flex flex-col gap-0","data-sentry-element":"SheetContent","data-sentry-source-file":"CreateHookSheet.tsx",children:[(0,a.jsx)(D.Fm,{className:"py-3 flex flex-row justify-between items-center border-b-0","data-sentry-element":"SheetHeader","data-sentry-source-file":"CreateHookSheet.tsx",children:(0,a.jsxs)("div",{className:"flex flex-row gap-3 items-center",children:[(0,a.jsxs)(D.kN,{className:(0,b.cn)("text-muted hover:text ring-offset-background transition-opacity hover:opacity-100","focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2","disabled:pointer-events-none data-[state=open]:bg-secondary","transition"),"data-sentry-element":"SheetClose","data-sentry-source-file":"CreateHookSheet.tsx",children:[(0,a.jsx)(M.A,{className:"h-3 w-3","data-sentry-element":"X","data-sentry-source-file":"CreateHookSheet.tsx"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]}),(0,a.jsx)(D.qp,{className:"truncate","data-sentry-element":"SheetTitle","data-sentry-source-file":"CreateHookSheet.tsx",children:g?"Add ".concat(s):"Update ".concat(s)})]})}),(0,a.jsx)(F.w,{"data-sentry-element":"Separator","data-sentry-source-file":"CreateHookSheet.tsx"}),(0,a.jsx)(D.Xc,{className:"overflow-auto flex-grow px-0","data-sentry-element":"SheetSection","data-sentry-source-file":"CreateHookSheet.tsx",children:(0,a.jsx)(B.lV,{...v,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"CreateHookSheet.tsx",children:(0,a.jsxs)("form",{id:G,className:"space-y-6 w-full py-5 flex-1",onSubmit:v.handleSubmit(C),children:[(0,a.jsx)(B.zB,{name:"enabled",control:v.control,render:e=>{let{field:t}=e;return(0,a.jsx)(q.M,{layout:"flex",className:"px-5",label:"Enable ".concat(N.hookType),description:"Send SMS hook"===N.hookType?"SMS Provider settings will be disabled in favor of SMS hooks":void 0,children:(0,a.jsx)(B.MJ,{children:(0,a.jsx)(W.d,{checked:t.value,onCheckedChange:t.onChange,disabled:t.disabled})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"CreateHookSheet.tsx"},"enabled"),(0,a.jsx)(F.w,{"data-sentry-element":"Separator","data-sentry-source-file":"CreateHookSheet.tsx"}),(0,a.jsx)(B.zB,{control:v.control,name:"selectedType",render:e=>{let{field:t}=e;return(0,a.jsx)(q.M,{label:"Hook type",className:"px-5",children:(0,a.jsx)(B.MJ,{children:(0,a.jsxs)(U.s,{value:t.value,onValueChange:e=>t.onChange(e),children:[(0,a.jsx)(U.v,{value:"postgres",id:"postgres",label:"Postgres",description:"Used to call a Postgres function."},"postgres"),(0,a.jsx)(U.v,{value:"https",id:"https",label:"HTTPS",description:"Used to call any HTTPS endpoint."},"https")]})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"CreateHookSheet.tsx"}),"postgres"===N.selectedType?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-8 px-5",children:[(0,a.jsx)(B.zB,{control:v.control,name:"postgresValues.schema",render:e=>{let{field:t}=e;return(0,a.jsx)(q.M,{label:"Postgres Schema",description:"Postgres schema where the function is defined",children:(0,a.jsx)(B.MJ,{children:(0,a.jsx)(z.A,{size:"small",showError:!1,selectedSchemaName:t.value,onSelectSchema:e=>t.onChange(e),disabled:t.disabled})})})}},"postgresValues.schema"),(0,a.jsx)(B.zB,{control:v.control,name:"postgresValues.functionName",render:e=>{let{field:t}=e;return(0,a.jsx)(q.M,{label:"Postgres function",description:"This function will be called by Supabase Auth each time the hook is triggered",children:(0,a.jsx)(B.MJ,{children:(0,a.jsx)(P.A,{size:"small",schema:N.postgresValues.schema,value:t.value,onChange:t.onChange,disabled:t.disabled,filterFunction:e=>{if(x.includes(e.return_type)){let{value:t}=(0,V.GQ)(e.argument_types);return 1===t.length&&("json"===t[0].type||"jsonb"===t[0].type)}return!1},noResultsLabel:(0,a.jsxs)("span",{children:["No function with a single JSON/B argument",(0,a.jsx)("br",{}),"and JSON/B","HOOK_SEND_EMAIL_ENABLED"===f.enabledKey?" or void":""," ","return type found in this schema."]})})})})}},"postgresValues.functionName")]}),(0,a.jsxs)("div",{className:"h-72 w-full gap-3 flex flex-col",children:[(0,a.jsx)("p",{className:"text-sm text-foreground-light px-5",children:"The following statements will be executed on the selected function:"}),(0,a.jsx)(u.A,{id:"postgres-hook-editor",isReadOnly:!0,language:"pgsql",value:w.join("\n\n")})]})]}):(0,a.jsxs)("div",{className:"flex flex-col gap-4 px-5",children:[(0,a.jsx)(B.zB,{control:v.control,name:"httpsValues.url",render:e=>{let{field:t}=e;return(0,a.jsx)(q.M,{label:"URL",description:"Supabase Auth will send a HTTPS POST request to this URL each time the hook is triggered.",children:(0,a.jsx)(B.MJ,{children:(0,a.jsx)($.p,{...t})})})}},"httpsValues.url"),(0,a.jsx)(B.zB,{control:v.control,name:"httpsValues.secret",render:e=>{let{field:t}=e;return(0,a.jsx)(q.M,{label:"Secret",description:(0,a.jsx)(K.$,{children:"It should be a base64 encoded hook secret with a prefix `v1,whsec_`. `v1` denotes the signature version, and `whsec_` signifies a symmetric secret."}),children:(0,a.jsx)(B.MJ,{children:(0,a.jsxs)("div",{className:"flex flex-row",children:[(0,a.jsx)($.p,{...t,className:"rounded-r-none border-r-0"}),(0,a.jsx)(A.$,{type:"default",size:"small",className:"rounded-l-none",onClick:()=>{let e=function(){let e=O()(60).toString("base64");return"v1,whsec_".concat(e)}();v.setValue("httpsValues.secret",e)},children:"Generate secret"})]})})})}},"httpsValues.secret")]})]})})}),(0,a.jsxs)(D.XW,{"data-sentry-element":"SheetFooter","data-sentry-source-file":"CreateHookSheet.tsx",children:[!g&&(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)(A.$,{type:"danger",onClick:()=>d(),children:"Delete hook"})}),(0,a.jsx)(A.$,{disabled:S,type:"default",onClick:()=>c(),"data-sentry-element":"Button","data-sentry-source-file":"CreateHookSheet.tsx",children:"Cancel"}),(0,a.jsx)(A.$,{form:G,htmlType:"submit",disabled:S,loading:S,"data-sentry-element":"Button","data-sentry-source-file":"CreateHookSheet.tsx",children:g?"Create hook":"Update hook"})]})]})})};var Y=s(31727),Q=s(64238),Z=s(71171),ee=s(38952),et=s(90206);let es=e=>{let{hook:t,onSelect:s}=e,r=(0,k.SE)(n.aG.AUTH_EXECUTE,"*");return(0,a.jsxs)("div",{className:"bg-surface-100 border-default overflow-hidden border shadow px-5 py-4 flex flex-row first:rounded-t-md last:rounded-b-md space-x-4","data-sentry-component":"HookCard","data-sentry-source-file":"HookCard.tsx",children:[(0,a.jsx)("div",{className:"",children:(0,a.jsx)(Y.A,{size:21,strokeWidth:"1","data-sentry-element":"Webhook","data-sentry-source-file":"HookCard.tsx"})}),(0,a.jsxs)("div",{className:"flex flex-col flex-0 overflow-y-auto w-full",children:[(0,a.jsx)("span",{className:"text-sm text-foreground",children:t.title}),(0,a.jsx)("span",{className:"text-sm text-foreground-lighter",children:t.subtitle}),(0,a.jsx)("div",{className:"text-sm flex flex-row space-x-5 py-4",children:"postgres"===t.method.type?(0,a.jsxs)("div",{className:"flex flex-col w-full space-y-2",children:[(0,a.jsxs)("div",{className:"flex flex-row items-center",children:[(0,a.jsx)("span",{className:"text-foreground-light w-20",children:"type"}),(0,a.jsx)("span",{className:"text-foreground",children:"Postgres function"})]}),(0,a.jsxs)("div",{className:"flex flex-row items-center",children:[(0,a.jsx)("span",{className:"text-foreground-light w-20",children:"schema"}),(0,a.jsx)(Z.A,{title:t.method.schema,copy:!0,readOnly:!0,disabled:!0,className:"input-mono [&>div>div>div>input]:text-xs [&>div>div>div>input]:opacity-100 flex-1",value:t.method.schema,onCopy:()=>"postgres"===t.method.type&&(0,et.lW)(t.method.schema)})]}),(0,a.jsxs)("div",{className:"flex flex-row items-center",children:[(0,a.jsx)("span",{className:"text-foreground-light w-20",children:"function"}),(0,a.jsx)(Z.A,{title:t.method.functionName,copy:!0,readOnly:!0,disabled:!0,className:"input-mono [&>div>div>div>input]:text-xs [&>div>div>div>input]:opacity-100 flex-1",value:t.method.functionName,onCopy:()=>"postgres"===t.method.type&&(0,et.lW)(t.method.functionName)})]})]}):(0,a.jsxs)("div",{className:"flex flex-col w-full space-y-2",children:[(0,a.jsxs)("div",{className:"flex flex-row items-center",children:[(0,a.jsx)("span",{className:"text-foreground-light w-20",children:"type"}),(0,a.jsx)("span",{className:"text-foreground",children:"HTTPS endpoint"})]}),(0,a.jsxs)("div",{className:"flex flex-row items-center",children:[(0,a.jsx)("span",{className:"text-foreground-light w-20",children:"endpoint"}),(0,a.jsx)(Z.A,{title:t.method.url,copy:!0,readOnly:!0,disabled:!0,className:"input-mono [&>div>div>div>input]:text-xs [&>div>div>div>input]:opacity-100 flex-1",value:t.method.url,onCopy:()=>"https"===t.method.type&&(0,et.lW)(t.method.url)})]}),(0,a.jsxs)("div",{className:"flex flex-row items-center",children:[(0,a.jsx)("span",{className:"text-foreground-light w-20",children:"secret"}),(0,a.jsx)(Z.A,{copy:!0,title:t.method.secret,reveal:!0,readOnly:!0,disabled:!0,className:"input-mono [&>div>div>div>input]:text-xs [&>div>div>div>input]:opacity-100 flex-1",value:t.method.secret})]})]})}),(0,a.jsx)("div",{className:"flex flex-row gap-2",children:(0,a.jsx)(w.G,{type:"default",disabled:!r,onClick:()=>s(),tooltip:{content:{side:"bottom",text:r?void 0:"You need additional permissions to configure auth hooks"}},"data-sentry-element":"ButtonTooltip","data-sentry-source-file":"HookCard.tsx",children:"Configure hook"})})]}),(0,a.jsx)("div",{className:"flex-1",children:t.enabled?(0,a.jsxs)(ee.E,{className:"space-x-1",variant:"brand",children:[(0,a.jsx)("div",{className:"h-3.5 w-3.5 bg-brand rounded-full flex justify-center items-center",children:(0,a.jsx)(Q.A,{className:"h-2 w-2 text-background-overlay ",strokeWidth:6})}),(0,a.jsx)("span",{children:"Enabled"})]}):(0,a.jsx)(ee.E,{variant:"warning",children:(0,a.jsx)("span",{children:"Disabled"})})})]})},ea=()=>{let{ref:e}=(0,o.g)(),{project:t}=(0,i.Om)(),{data:s,error:n,isError:m}=(0,h.op)({projectRef:e}),[f,x]=(0,r.useState)(null),[p,g]=(0,r.useState)(null),{mutate:N,isLoading:w}=y({onSuccess:async()=>{if(!p)return;let{method:s}=p;if("postgres"===s.type){let a=(0,T.IT)(s.schema,s.functionName);await (0,j.E)({projectRef:e,connectionString:t.connectionString,sql:a.join("\n")})}l.oR.success("".concat(p.title," has been deleted.")),g(null),x(null)},onError:e=>{l.oR.error("Failed to delete hook: ".concat(e.message))}}),k=_.map(e=>({...e,enabled:(null==s?void 0:s[e.enabledKey])||!1,method:(0,T.vw)((null==s?void 0:s[e.uriKey])||"",(null==s?void 0:s[e.secretsKey])||"")}));return m?(0,a.jsx)(d.A,{error:n,subject:"Failed to retrieve auth configuration for hooks"}):(0,a.jsxs)(c.gu,{isFullWidth:!0,"data-sentry-element":"ScaffoldSection","data-sentry-component":"HooksListing","data-sentry-source-file":"HooksListing.tsx",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)(c.sZ,{"data-sentry-element":"ScaffoldSectionTitle","data-sentry-source-file":"HooksListing.tsx",children:"All hooks"}),(0,a.jsx)(E,{onSelectHook:x,"data-sentry-element":"AddHookDropdown","data-sentry-source-file":"HooksListing.tsx"})]}),0===k.filter(e=>(0,T.U2)(e)).length&&(0,a.jsxs)("div",{className:"border rounded border-default px-20 py-16 flex flex-col items-center justify-center space-y-4",children:[(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"No hooks configured yet"}),(0,a.jsx)(E,{align:"center",buttonText:"Add a new hook",onSelectHook:x})]}),(0,a.jsx)("div",{className:"-space-y-px",children:k.filter(e=>(0,T.U2)(e)).map(e=>(0,a.jsx)(es,{hook:e,onSelect:()=>x(e.title)},e.enabledKey))}),(0,a.jsx)(X,{title:f,visible:!!f,onDelete:()=>{let e=k.find(e=>e.title===f);e&&g(e)},onClose:()=>x(null),authConfig:s,"data-sentry-element":"CreateHookSheet","data-sentry-source-file":"HooksListing.tsx"}),(0,a.jsx)(v.A,{visible:!!p,size:"large",variant:"destructive",loading:w,title:"Confirm to delete ".concat(null==p?void 0:p.title),confirmLabel:"Delete",confirmLabelLoading:"Deleting",onCancel:()=>g(null),onConfirm:()=>{p&&N({projectRef:e,config:{[p.enabledKey]:!1,[p.uriKey]:null,[p.secretsKey]:null}})},"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"HooksListing.tsx",children:(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"text-sm text-foreground-light",children:["Are you sure you want to delete the ",null==p?void 0:p.title,"?"]}),(null==p?void 0:p.method.type)==="postgres"&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("p",{className:"text-sm text-foreground-light",children:["The following statements will be executed on the"," ",null==p?void 0:p.method.schema,".",null==p?void 0:p.method.functionName," function:"]}),(0,a.jsx)("div",{className:(0,b.cn)("mt-4","h-72"),children:(0,a.jsx)(u.A,{id:"deletion-hook-editor",isReadOnly:!0,language:"pgsql",value:(0,T.IT)(null==p?void 0:p.method.schema,null==p?void 0:p.method.functionName).join("\n\n")})})]})]})})]})};var en=s(47028),er=s(6408),el=s(60479),eo=s(93274);let ei=()=>{let e=(0,k.SE)(n.aG.READ,"custom_config_gotrue");return(0,k.Lh)()&&!e?(0,a.jsx)(eo.A,{isFullPage:!0,resourceText:"access your project's auth hooks"}):(0,a.jsx)(c.eh,{"data-sentry-element":"ScaffoldContainer","data-sentry-component":"Hooks","data-sentry-source-file":"hooks.tsx",children:(0,a.jsx)(ea,{"data-sentry-element":"HooksListing","data-sentry-source-file":"hooks.tsx"})})};ei.getLayout=e=>(0,a.jsx)(er.A,{children:(0,a.jsx)(en.A,{children:(0,a.jsx)(el.M,{title:"Auth Hooks",subtitle:"Use Postgres functions or HTTP endpoints to customize the behavior of Supabase Auth to meet your needs",children:e})})});let ec=ei},86137:(e,t,s)=>{"use strict";s.d(t,{$E:()=>d,kV:()=>i,op:()=>c});var a=s(56947),n=s(32144),r=s(3807),l=s(53239),o=s(67849);async function i(e,t){let{projectRef:s}=e;if(!s)throw Error("projectRef is required");let{data:a,error:n}=await (0,r.Jt)("/platform/auth/{ref}/config",{params:{path:{ref:s}},signal:t});return n&&(0,r.H4)(n),a}let c=function(e){let{projectRef:t}=e,{enabled:s=!0,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,a.I)(o.Z.authConfig(t),e=>{let{signal:s}=e;return i({projectRef:t},s)},{enabled:s&&void 0!==t,...n})},d=e=>{let{projectRef:t}=e,s=(0,n.jE)();return(0,l.useCallback)(()=>{t&&s.prefetchQuery(o.Z.authConfig(t),e=>{let{signal:s}=e;return i({projectRef:t},s)})},[s,t])}},89426:(e,t,s)=>{"use strict";s.d(t,{IT:()=>r,U2:()=>n,vw:()=>a});let a=(e,t)=>{if(e.startsWith("https"))return{type:"https",url:e,secret:t||""};{let[t,s,a,n,r]=(e||"").split("/");return{type:"postgres",schema:n||"",functionName:r||""}}},n=e=>"postgres"===e.method.type&&e.method.schema.length>0&&e.method.functionName.length>0||"https"===e.method.type&&e.method.url.startsWith("https")&&e.method.secret.length>0,r=(e,t)=>["-- Revoke access to function from supabase_auth_admin\nrevoke execute on function ".concat(e,".").concat(t," from supabase_auth_admin;"),"-- Revoke access to schema from supabase_auth_admin\nrevoke usage on schema ".concat(e," from supabase_auth_admin;"),"-- Restore function permissions to authenticated, anon and public\ngrant execute on function ".concat(e,".").concat(t," to authenticated, anon, public;")]},93226:(e,t,s)=>{var a=s(15599),n=a.Buffer;function r(e,t){for(var s in e)t[s]=e[s]}function l(e,t,s){return n(e,t,s)}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?e.exports=a:(r(a,t),t.Buffer=l),l.prototype=Object.create(n.prototype),r(n,l),l.from=function(e,t,s){if("number"==typeof e)throw TypeError("Argument must not be a number");return n(e,t,s)},l.alloc=function(e,t,s){if("number"!=typeof e)throw TypeError("Argument must be a number");var a=n(e);return void 0!==t?"string"==typeof s?a.fill(t,s):a.fill(t):a.fill(0),a},l.allocUnsafe=function(e){if("number"!=typeof e)throw TypeError("Argument must be a number");return n(e)},l.allocUnsafeSlow=function(e){if("number"!=typeof e)throw TypeError("Argument must be a number");return a.SlowBuffer(e)}},93274:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});var a=s(80263),n=s(65325);let r=e=>{let{resourceText:t,isFullPage:s=!1}=e,r=()=>(0,a.jsx)("div",{className:"block w-full rounded border border-opacity-20 py-4 px-6 border-overlay bg-surface-200","data-sentry-component":"NoPermissionMessage","data-sentry-source-file":"NoPermission.tsx",children:(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsx)("div",{className:"mt-1",children:(0,a.jsx)(n.A,{size:20,"data-sentry-element":"AlertCircle","data-sentry-source-file":"NoPermission.tsx"})}),(0,a.jsx)("div",{className:"flex w-full items-center justify-between",children:(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("p",{className:"text-sm",children:["You need additional permissions to ",t]}),(0,a.jsx)("div",{children:(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"Contact your organization owner or administrator for assistance."})})]})})]})});return s?(0,a.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,a.jsx)("div",{className:"w-[550px]",children:(0,a.jsx)(r,{})})}):(0,a.jsx)(r,{})}},95207:(e,t,s)=>{"use strict";s.d(t,{BS:()=>o,Dm:()=>d,HJ:()=>j,Rf:()=>g,Uw:()=>c,Vw:()=>N,Xr:()=>v,aw:()=>x,bV:()=>l,cJ:()=>m,dX:()=>u,eh:()=>i,fh:()=>b,gu:()=>h,sZ:()=>f,tn:()=>y,xp:()=>p});var a=s(80263),n=s(53239),r=s(2);let l="mx-auto w-full max-w-[1200px]",o="px-4 @lg:px-6 @xl:px-12 @2xl:px-20 @3xl:px-24",i=(0,n.forwardRef)((e,t)=>{let{className:s,bottomPadding:n,size:l="default",...i}=e;return(0,a.jsx)("div",{ref:t,...i,className:(0,r.cn)("mx-auto w-full",{small:"max-w-[768px]",default:"max-w-[1200px]",large:"max-w-[1600px]",full:"max-w-none"}[l],o,n&&"pb-16",s)})}),c=(0,n.forwardRef)((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("header",{...n,ref:t,className:(0,r.cn)("w-full","flex-col gap-3 py-6",s)})}),d=(0,n.forwardRef)((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("h1",{ref:t,...n,className:(0,r.cn)("text-2xl",s)})}),u=(0,n.forwardRef)((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("p",{ref:t,...n,className:(0,r.cn)("text-sm text-foreground-light",s)})}),h=(0,n.forwardRef)((e,t)=>{let{className:s,isFullWidth:n,topPadding:l,...o}=e;return(0,a.jsx)("div",{ref:t,...o,className:(0,r.cn)("flex flex-col first:pt-12 py-6",n?"w-full":"gap-3 lg:grid md:grid-cols-12",s)})}),m=(0,n.forwardRef)((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{ref:t,...n,className:(0,r.cn)("w-full h-px bg-border",s)})}),f=(0,n.forwardRef)((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("h3",{ref:t,...n,className:(0,r.cn)("text-foreground text-xl",s)})}),x=(0,n.forwardRef)((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("p",{ref:t,...n,className:(0,r.cn)("text-sm text-foreground-light",s)})}),p=(0,n.forwardRef)((e,t)=>{let{className:s,children:n,title:l,...o}=e;return(0,a.jsxs)("div",{ref:t,...o,className:(0,r.cn)("col-span-4 xl:col-span-5 prose text-sm",s),children:[l&&(0,a.jsx)("h2",{children:l}),n]})}),g=(0,n.forwardRef)((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{ref:t,...n,className:(0,r.cn)("col-span-8 xl:col-span-7","flex flex-col gap-6",s)})}),y=(0,n.forwardRef)((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{ref:t,...n,className:(0,r.cn)("flex flex-col gap-3 items-center",s)})}),j=(0,n.forwardRef)((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{ref:t,...n,className:(0,r.cn)("flex w-full items-center",s)})}),b=(0,n.forwardRef)((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{ref:t,...n,className:(0,r.cn)("flex flex-row gap-3",s)})}),v=(0,n.forwardRef)((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{ref:t,...n,className:(0,r.cn)("flex flex-col gap-3","min-w-[420px]",s)})}),N=(0,n.forwardRef)((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{ref:t,...n,className:(0,r.cn)(l,o,"my-8 flex flex-col gap-8",s)})});c.displayName="ScaffoldHeader",d.displayName="ScaffoldTitle",u.displayName="ScaffoldDescription",i.displayName="ScaffoldContainer",m.displayName="ScaffoldDivider",h.displayName="ScaffoldSection",v.displayName="ScaffoldColumn",p.displayName="ScaffoldSectionDetail",g.displayName="ScaffoldSectionContent",y.displayName="ScaffoldFilterAndContent",j.displayName="ScaffoldActionsContainer",b.displayName="ScaffoldActionsGroup",N.displayName="ScaffoldContainerLegacy",f.displayName="ScaffoldSectionTitle",x.displayName="ScaffoldSectionDescription"},97344:(e,t,s)=>{var a=s(58381),n=s(51276),r=s(5689),l=s(33312),o=s(89527),i=s(79661),c=s(86458),d=s(63570),u=Object.prototype.hasOwnProperty;e.exports=function(e){if(null==e)return!0;if(o(e)&&(l(e)||"string"==typeof e||"function"==typeof e.splice||i(e)||d(e)||r(e)))return!e.length;var t=n(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(c(e))return!a(e).length;for(var s in e)if(u.call(e,s))return!1;return!0}},99673:(e,t,s)=>{"use strict";s.d(t,{O:()=>o,h:()=>l});var a=s(80263),n=s(53239),r=s(2);let l=(0,n.forwardRef)((e,t)=>(0,a.jsx)("nav",{ref:t,dir:"ltr",...e,className:(0,r.cn)("border-b",e.className),children:(0,a.jsx)("ul",{role:"menu",className:"flex gap-5",children:e.children})})),o=(0,n.forwardRef)((e,t)=>{let{children:s,className:n,active:l,...o}=e;return(0,a.jsx)("li",{ref:t,"aria-selected":l?"true":"false","data-state":l?"active":"inactive",className:(0,r.cn)("inline-flex items-center justify-center whitespace-nowrap text-sm ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:text-foreground text-foreground-lighter hover:text-foreground data-[state=active]:border-foreground border-b-2 border-transparent *:py-1.5",n),...o,children:s})})}},e=>{var t=t=>e(e.s=t);e.O(0,[89,2479,8058,9353,9413,3730,6110,6182,589,9257,1673,5599,7990,8508,4365,2981,7406,6554,4560,4963,408,4340,30,1202,5969,3719,9472,9088,3423,1252,7613,8601,6593,636,8792],()=>t(60740)),_N_E=e.O()}]);