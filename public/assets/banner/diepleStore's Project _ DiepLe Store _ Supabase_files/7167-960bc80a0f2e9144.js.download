!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="1baf0286-b4ee-45c0-af21-74a972d6e884",e._sentryDebugIdIdentifier="sentry-dbid-1baf0286-b4ee-45c0-af21-74a972d6e884")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7167],{39079:(e,t,a)=>{a.d(t,{A:()=>s});let s=(0,a(47370).A)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},57167:(e,t,a)=>{a.d(t,{A:()=>ed});var s=a(80263),l=a(47613),i=a(53239),n=a(73969),r=a(1498),o=a(83634),c=a(29730),d=a(58897),u=a(43526),m=a(88601),p=a(60045),h=a(56404),x=a(12015),f=a(66828),y=a(63320),b=a.n(y),j=a(52385),g=a(68656),v=a(62927),_=a(36643),k=a(67330),w=a(32144),N=a(80251),A=a(3807),S=a(55388);async function C(e){let{projectRef:t,id:a,isPublic:s,file_size_limit:l,allowed_mime_types:i}=e;if(!t)throw Error("projectRef is required");if(!a)throw Error("Bucket name is required");let n={id:a,public:s};l&&(n.file_size_limit=l),i&&n.allowed_mime_types;let{data:r,error:o}=await (0,A.bE)("/platform/storage/{ref}/buckets",{params:{path:{ref:t}},body:n});return o&&(0,A.H4)(o),r}let z=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,w.jE)();return(0,N.n)(e=>C(e),{async onSuccess(t,a,l){let{projectRef:i}=a;await s.invalidateQueries(S.w.buckets(i)),await (null==e?void 0:e(t,a,l))},async onError(e,a,s){void 0===t?n.oR.error("Failed to create bucket: ".concat(e.message)):t(e,a,s)},...a})};var E=a(55335),M=a(80109),B=a(71171),T=a(51405),R=a(69763),I=a(70639),F=a(2),O=a(98040),L=a(16601);let P=e=>{var t;let{visible:a,onClose:r}=e,{ref:o}=(0,l.g)(),c=(0,j.useRouter)(),{mutate:u,isLoading:m}=z({onSuccess:e=>{n.oR.success("Successfully created bucket ".concat(e.name)),c.push("/project/".concat(o,"/storage/buckets/").concat(e.name)),r()}}),{data:p}=(0,k.I)({projectRef:o},{enabled:d.pe&&a}),{value:h,unit:x}=(0,_.Jb)(null!=(t=null==p?void 0:p.fileSizeLimit)?t:0),f="".concat(h," ").concat(x),[y,w]=(0,i.useState)(v.s.BYTES),[N,A]=(0,i.useState)(!1),S=async e=>{if(!o)return console.error("Project ref is required");u({projectRef:o,id:e.name,isPublic:e.public,file_size_limit:e.has_file_size_limit?(0,_.OG)(e.formatted_size_limit,y):null,allowed_mime_types:e.allowed_mime_types.length>0?e.allowed_mime_types.split(",").map(e=>e.trim()):null})};return(0,i.useEffect)(()=>{a&&(w(v.s.BYTES),A(!1))},[a]),(0,s.jsx)(E.A,{hideFooter:!0,visible:a,size:"medium",header:"Create storage bucket",onCancel:()=>r(),"data-sentry-element":"Modal","data-sentry-component":"CreateBucketModal","data-sentry-source-file":"CreateBucketModal.tsx",children:(0,s.jsx)(M.A,{validateOnBlur:!1,initialValues:{name:"",public:!1,file_size_limit:0,allowed_mime_types:"",has_file_size_limit:!1,formatted_size_limit:0},validate:e=>{let t={};return e.name||(t.name="Please provide a name for your bucket"),e.name&&!/^[a-z0-9.-]+$/.test(e.name)&&(t.name="The name of the bucket must only container lowercase letters, numbers, dots, and hyphens"),e.name&&e.name.endsWith(" ")&&(t.name="The name of the bucket cannot end with a whitespace"),e.has_file_size_limit&&e.formatted_size_limit<0&&(t.formatted_size_limit="File size upload limit has to be at least 0"),"public"===e.name&&(t.name='"public" is a reserved name. Please choose another name'),t},onSubmit:S,"data-sentry-element":"Form","data-sentry-source-file":"CreateBucketModal.tsx",children:e=>{let{values:t}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(E.A.Content,{children:[(0,s.jsx)(B.A,{id:"name",name:"name",type:"text",className:"w-full",layout:"vertical",label:"Name of bucket",labelOptional:"Buckets cannot be renamed once created.",descriptionText:"Only lowercase letters, numbers, dots, and hyphens"}),(0,s.jsxs)("div",{className:"space-y-2 mt-6",children:[(0,s.jsx)(T.A,{id:"public",name:"public",layout:"flex",label:"Public bucket",descriptionText:"Anyone can read any object without any authorization"}),t.public&&(0,s.jsxs)(R.F,{title:"Public buckets are not protected",variant:"warning",withIcon:!0,children:[(0,s.jsx)("p",{className:"mb-2",children:"Users can read objects in public buckets without any authorization."}),(0,s.jsx)("p",{children:"Row level security (RLS) policies are still required for other operations such as object uploads and deletes."})]})]})]}),(0,s.jsxs)(I.Ay,{open:N,onOpenChange:()=>A(!N),children:[(0,s.jsx)(I.Ay.Trigger,{asChild:!0,children:(0,s.jsxs)("div",{className:"w-full cursor-pointer py-3 px-5 flex items-center justify-between border-t border-default",children:[(0,s.jsx)("p",{className:"text-sm",children:"Additional configuration"}),(0,s.jsx)(g.A,{size:18,strokeWidth:2,className:(0,F.cn)("text-foreground-light",N&&"rotate-180")})]})}),(0,s.jsx)(I.Ay.Content,{className:"py-4",children:(0,s.jsxs)("div",{className:"w-full space-y-5 px-5",children:[(0,s.jsxs)("div",{className:"space-y-5",children:[(0,s.jsx)(T.A,{id:"has_file_size_limit",name:"has_file_size_limit",layout:"flex",label:"Restrict file upload size for bucket",descriptionText:"Prevent uploading of file sizes greater than a specified limit"}),t.has_file_size_limit&&(0,s.jsxs)("div",{className:"grid grid-cols-12 col-span-12 gap-x-2 gap-y-1",children:[(0,s.jsx)("div",{className:"col-span-8",children:(0,s.jsx)(B.A,{type:"number",step:1,id:"formatted_size_limit",name:"formatted_size_limit",disabled:!1,onKeyPress:e=>{(e.charCode<48||e.charCode>57)&&e.preventDefault()},descriptionText:"Equivalent to ".concat((0,_.OG)(t.formatted_size_limit,y).toLocaleString()," bytes.")})}),(0,s.jsx)("div",{className:"col-span-4",children:(0,s.jsx)(O.A,{id:"size_limit_units",disabled:!1,value:y,onChange:w,children:Object.values(v.s).map(e=>(0,s.jsx)(O.A.Option,{label:e,value:e,children:(0,s.jsx)("div",{children:e})},e))})}),d.pe&&(0,s.jsx)("div",{className:"col-span-12",children:(0,s.jsxs)("p",{className:"text-foreground-light text-sm",children:["Note: Individual bucket uploads will still be capped at the"," ",(0,s.jsx)(b(),{href:"/project/".concat(o,"/settings/storage"),className:"font-bold underline",children:"global upload limit"})," ","of ",f]})})]})]}),(0,s.jsx)(B.A,{id:"allowed_mime_types",name:"allowed_mime_types",layout:"vertical",label:"Allowed MIME types",placeholder:"e.g image/jpeg, image/png, audio/mpeg, video/mp4, etc",labelOptional:"Comma separated values",descriptionText:"Wildcards are allowed, e.g. image/*. Leave blank to allow any MIME type."})]})})]}),(0,s.jsx)(E.A.Separator,{}),(0,s.jsxs)(E.A.Content,{className:"flex items-center space-x-2 justify-end",children:[(0,s.jsx)(L.$,{type:"default",htmlType:"button",disabled:m,onClick:()=>r(),children:"Cancel"}),(0,s.jsx)(L.$,{type:"primary",htmlType:"submit",loading:m,disabled:m,children:"Save"})]})]})}})})};async function W(e){let{projectRef:t,id:a,isPublic:s,file_size_limit:l,allowed_mime_types:i}=e;if(!t)throw Error("projectRef is required");if(!a)throw Error("Bucket name is requried");let n={public:s};void 0!==l&&(n.file_size_limit=l),void 0!==i&&(n.allowed_mime_types=i);let{data:r,error:o}=await (0,A.F6)("/platform/storage/{ref}/buckets/{id}",{params:{path:{id:a,ref:t}},body:n});return o&&(0,A.H4)(o),r}let q=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,w.jE)();return(0,N.n)(e=>W(e),{async onSuccess(t,a,l){let{projectRef:i}=a;await s.invalidateQueries(S.w.buckets(i)),await (null==e?void 0:e(t,a,l))},async onError(e,a,s){void 0===t?n.oR.error("Failed to update bucket: ".concat(e.message)):t(e,a,s)},...a})},D=e=>{var t;let{visible:a,bucket:r,onClose:o}=e,{ref:c}=(0,l.g)(),{mutate:u,isLoading:m}=q({onSuccess:()=>{n.oR.success('Successfully updated bucket "'.concat(null==r?void 0:r.name,'"')),o()}}),{data:p}=(0,k.I)({projectRef:c},{enabled:d.pe&&a}),{value:h,unit:x}=(0,_.Jb)(null!=(t=null==p?void 0:p.fileSizeLimit)?t:0),f="".concat(h," ").concat(x),[y,j]=(0,i.useState)(v.s.BYTES),[w,N]=(0,i.useState)(!1),A=async e=>void 0===r?console.error("Bucket is required"):void 0===c?console.error("Project ref is required"):void u({projectRef:c,id:r.id,isPublic:e.public,file_size_limit:e.has_file_size_limit?(0,_.OG)(e.formatted_size_limit,y):null,allowed_mime_types:e.allowed_mime_types.length>0?e.allowed_mime_types.split(",").map(e=>e.trim()):null});return(0,i.useEffect)(()=>{if(a){var e;let{unit:t}=(0,_.Jb)(null!=(e=null==r?void 0:r.file_size_limit)?e:0);j(t),N(!1)}},[a]),(0,s.jsx)(E.A,{hideFooter:!0,visible:a,size:"medium",header:'Edit bucket "'.concat(null==r?void 0:r.name,'"'),onCancel:o,"data-sentry-element":"Modal","data-sentry-component":"EditBucketModal","data-sentry-source-file":"EditBucketModal.tsx",children:(0,s.jsx)(M.A,{validateOnBlur:!1,initialValues:{},validate:e=>{let t={};return e.has_file_size_limit&&e.formatted_size_limit<0&&(t.formatted_size_limit="File size upload limit has to be at least 0"),t},onSubmit:A,"data-sentry-element":"Form","data-sentry-source-file":"EditBucketModal.tsx",children:e=>{let{values:t,resetForm:l}=e;return(0,i.useEffect)(()=>{if(a&&void 0!==r){var e,t,s;let{value:a}=(0,_.Jb)(null!=(e=r.file_size_limit)?e:0),i={name:null!=(t=r.name)?t:"",public:r.public,file_size_limit:r.file_size_limit,allowed_mime_types:(null!=(s=r.allowed_mime_types)?s:[]).join(", "),has_file_size_limit:null!==r.file_size_limit,formatted_size_limit:null!=a?a:0};l({values:i,initialValues:i})}},[a]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(E.A.Content,{children:[(0,s.jsx)(B.A,{disabled:!0,id:"name",name:"name",type:"text",className:"w-full",layout:"vertical",label:"Name of bucket",labelOptional:"Buckets cannot be renamed once created."}),(0,s.jsxs)("div",{className:"space-y-2 mt-6",children:[(0,s.jsx)(T.A,{id:"public",name:"public",layout:"flex",label:"Public bucket",descriptionText:"Anyone can read any object without any authorization"}),(null==r?void 0:r.public)!==t.public&&(0,s.jsx)(R.F,{title:(null==r?void 0:r.public)||!t.public?(null==r?void 0:r.public)&&!t.public?"Warning: Making bucket private":"":"Warning: Making bucket public",variant:"warning",withIcon:!0,children:(0,s.jsx)("p",{className:"mb-2",children:(null==r?void 0:r.public)||!t.public?(null==r?void 0:r.public)&&!t.public?'All objects in "'.concat(null==r?void 0:r.name,'" will be made private and will only be accessible via signed URLs or downloaded with the right authorisation headers'):"":'This will make all objects in the bucket "'.concat(null==r?void 0:r.name,'" public')})})]})]}),(0,s.jsxs)(I.Ay,{open:w,onOpenChange:()=>N(!w),children:[(0,s.jsx)(I.Ay.Trigger,{asChild:!0,children:(0,s.jsxs)("div",{className:"w-full cursor-pointer py-3 px-5 flex items-center justify-between border-t border-default",children:[(0,s.jsx)("p",{className:"text-sm",children:"Additional configuration"}),(0,s.jsx)(g.A,{size:18,strokeWidth:2,className:(0,F.cn)("text-foreground-light",w&&"rotate-180")})]})}),(0,s.jsx)(I.Ay.Content,{className:"py-4",children:(0,s.jsxs)("div",{className:"w-full space-y-4 px-5",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(T.A,{id:"has_file_size_limit",name:"has_file_size_limit",layout:"flex",label:"Restrict file upload size for bucket",descriptionText:"Prevent uploading of file sizes greater than a specified limit"}),t.has_file_size_limit&&(0,s.jsxs)("div",{className:"grid grid-cols-12 col-span-12 gap-x-2 gap-y-1",children:[(0,s.jsx)("div",{className:"col-span-8",children:(0,s.jsx)(B.A,{type:"number",step:1,id:"formatted_size_limit",name:"formatted_size_limit",disabled:!1,onKeyPress:e=>{(e.charCode<48||e.charCode>57)&&e.preventDefault()},descriptionText:"Equivalent to ".concat((0,_.OG)(t.formatted_size_limit,y).toLocaleString()," bytes.")})}),(0,s.jsx)("div",{className:"col-span-4",children:(0,s.jsx)(O.A,{id:"size_limit_units",disabled:!1,value:y,onChange:j,children:Object.values(v.s).map(e=>(0,s.jsx)(O.A.Option,{label:e,value:e,children:(0,s.jsx)("div",{children:e})},e))})}),d.pe&&(0,s.jsx)("div",{className:"col-span-12 mt-2",children:(0,s.jsxs)("p",{className:"text-foreground-light text-sm",children:["Note: Individual bucket upload will still be capped at the"," ",(0,s.jsx)(b(),{href:"/project/".concat(c,"/settings/storage"),className:"font-bold underline",children:"global upload limit"})," ","of ",f]})})]})]}),(0,s.jsx)(B.A,{id:"allowed_mime_types",name:"allowed_mime_types",layout:"vertical",label:"Allowed MIME types",placeholder:"e.g image/jpeg, image/png, audio/mpeg, video/mp4, etc",labelOptional:"Comma separated values",descriptionText:"Wildcards are allowed, e.g. image/*. Leave blank to allow any MIME type."})]})})]}),(0,s.jsx)(E.A.Separator,{}),(0,s.jsxs)(E.A.Content,{className:"flex items-center space-x-2 justify-end",children:[(0,s.jsx)(L.$,{type:"default",disabled:m,onClick:()=>o(),children:"Cancel"}),(0,s.jsx)(L.$,{type:"primary",htmlType:"submit",loading:m,disabled:m,children:"Save"})]})]})}})})};var G=a(44231);async function Q(e){let{projectRef:t,id:a}=e;if(!t)throw Error("projectRef is required");if(!a)throw Error("Bucket name is requried");let{data:s,error:l}=await (0,A.bE)("/platform/storage/{ref}/buckets/{id}/empty",{params:{path:{id:a,ref:t}}});return l&&(0,A.H4)(l),s}let U=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,w.jE)();return(0,N.n)(e=>Q(e),{async onSuccess(t,a,l){let{projectRef:i}=a;await s.invalidateQueries(S.w.buckets(i)),await (null==e?void 0:e(t,a,l))},async onError(e,a,s){void 0===t?n.oR.error("Failed to empty bucket: ".concat(e.message)):t(e,a,s)},...a})};var V=a(36212);let $=e=>{let{visible:t=!1,bucket:a,onClose:i}=e,{ref:r}=(0,l.g)(),{fetchFolderContents:o}=(0,u.W)(),{mutate:c,isLoading:d}=U({onSuccess:async()=>{void 0!==a&&(await o(a.id,a.name,-1),n.oR.success("Successfully deleted bucket ".concat(a.name)),i())}}),m=async()=>r?a?void c({projectRef:r,id:a.id}):console.error("No bucket is selected"):console.error("Project ref is required");return(0,s.jsx)(V.A,{variant:"destructive",size:"small",title:"Confirm to delete all contents from ".concat(null==a?void 0:a.name),confirmLabel:"Empty bucket",visible:t,onCancel:()=>i(),onConfirm:m,alert:{title:"This action cannot be undone",description:"The contents of your bucket cannot be recovered once deleted"},"data-sentry-element":"ConfirmationModal","data-sentry-component":"EmptyBucketModal","data-sentry-source-file":"EmptyBucketModal.tsx",children:(0,s.jsxs)("p",{className:"text-sm",children:['Are you sure you want to empty the bucket "',null==a?void 0:a.name,'"?']})})};var K=a(79319),Y=a(17234),H=a(23910),J=a(65904),X=a(42677),Z=a(98883),ee=a(63505),et=a(83927),ea=a.n(et),es=a(99985),el=a(39079),ei=a(94328),en=a(38952),er=a(33656);let eo=e=>{let{bucket:t,projectRef:a="",isSelected:l=!1,onSelectEmptyBucket:i=ea(),onSelectDeleteBucket:n=ea(),onSelectEditBucket:r=ea()}=e,o=(0,J.SE)(p.aG.STORAGE_WRITE,"*");return(0,s.jsxs)("div",{className:(0,F.cn)("group flex items-center justify-between rounded-md",l&&"text-foreground bg-surface-100"),"data-sentry-component":"BucketRow","data-sentry-source-file":"BucketRow.tsx",children:[(0,s.jsx)(b(),{href:"/project/".concat(a,"/storage/buckets/").concat(encodeURIComponent(t.id)),className:(0,F.cn)("py-1 px-3",l?"w-[88%]":"w-full"),"data-sentry-element":"Link","data-sentry-source-file":"BucketRow.tsx",children:(0,s.jsxs)("div",{className:"flex items-center justify-between space-x-2 truncate w-full",children:[(0,s.jsx)("p",{className:"text-sm group-hover:text-foreground transition truncate ".concat(l?"text-foreground":"text-foreground-light"),title:t.name,children:t.name}),t.public&&(0,s.jsx)(en.E,{variant:"warning",children:"Public"})]})}),o&&l?(0,s.jsxs)(er.rI,{children:[(0,s.jsx)(er.ty,{asChild:!0,children:(0,s.jsx)(L.$,{type:"text",icon:(0,s.jsx)(g.A,{}),className:"mr-1 p-0.5"})}),(0,s.jsxs)(er.SQ,{side:"bottom",align:"start",children:[(0,s.jsxs)(er._2,{className:"space-x-2",onClick:()=>r(),children:[(0,s.jsx)(es.A,{size:14}),(0,s.jsx)("p",{children:"Edit bucket"})]},"toggle-private"),(0,s.jsx)(er.mB,{}),(0,s.jsxs)(er._2,{className:"space-x-2",onClick:()=>i(),children:[(0,s.jsx)(el.A,{size:14}),(0,s.jsx)("p",{children:"Empty bucket"})]},"empty-bucket"),(0,s.jsxs)(er._2,{className:"space-x-2",onClick:()=>n(),children:[(0,s.jsx)(ei.A,{size:14}),(0,s.jsx)("p",{children:"Delete bucket"})]},"delete-bucket")]})]}):(0,s.jsx)("div",{className:"w-5"})]},t.id)},ec=()=>{let e=(0,j.useRouter)(),{ref:t,bucketId:a}=(0,l.g)(),n=(0,o.KT)(),r=(null==n?void 0:n.parent_project_ref)!==void 0,[c,d]=(0,i.useState)(""),[u,m]=(0,i.useState)(!1),[y,g]=(0,i.useState)(),[v,_]=(0,i.useState)(),[k,w]=(0,i.useState)(),N=(0,J.SE)(p.aG.STORAGE_WRITE,"*"),[A,S]=(0,h.Mj)("storage-explorer-sort","created-at"),C=e.pathname.split("/")[4],{data:z=[],error:E,isLoading:M,isError:B,isSuccess:T}=(0,H.p)({projectRef:t}),R="alphabetical"===A?z.sort((e,t)=>e.name.toLowerCase().trim().localeCompare(t.name.toLowerCase().trim())):z.sort((e,t)=>new Date(t.created_at)>new Date(e.created_at)?-1:1),I=c.length>1?R.filter(e=>e.name.includes(c.trim())):R,F=(null==E?void 0:E.message.includes("Tenant config"))&&r;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(X.Ay,{type:"pills",className:"my-6 flex flex-grow flex-col","data-sentry-element":"Menu","data-sentry-source-file":"StorageMenu.tsx",children:[(0,s.jsxs)("div",{className:"mb-6 mx-5 flex flex-col gap-y-1.5",children:[(0,s.jsx)(K.G,{block:!0,type:"default",icon:(0,s.jsx)(x.A,{}),disabled:!N,style:{justifyContent:"start"},onClick:()=>m(!0),tooltip:{content:{side:"bottom",text:N?void 0:"You need additional permissions to create buckets"}},"data-sentry-element":"ButtonTooltip","data-sentry-source-file":"StorageMenu.tsx",children:"New bucket"}),(0,s.jsx)(ee.a0,{className:"px-0","data-sentry-element":"InnerSideBarFilters","data-sentry-source-file":"StorageMenu.tsx",children:(0,s.jsx)(ee.RK,{name:"search-buckets","aria-labelledby":"Search buckets",placeholder:"Search buckets...",value:c,onChange:e=>{d(e.target.value)},"data-sentry-element":"InnerSideBarFilterSearchInput","data-sentry-source-file":"StorageMenu.tsx",children:(0,s.jsxs)(ee.i9,{value:A,onValueChange:e=>S(e),"data-sentry-element":"InnerSideBarFilterSortDropdown","data-sentry-source-file":"StorageMenu.tsx",children:[(0,s.jsx)(ee.Pl,{value:"alphabetical",className:"flex gap-2","data-sentry-element":"InnerSideBarFilterSortDropdownItem","data-sentry-source-file":"StorageMenu.tsx",children:"Alphabetical"},"alphabetical"),(0,s.jsx)(ee.Pl,{value:"created-at","data-sentry-element":"InnerSideBarFilterSortDropdownItem","data-sentry-source-file":"StorageMenu.tsx",children:"Created at"},"created-at")]})})})]}),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"mx-3",children:[(0,s.jsx)(X.Ay.Group,{title:(0,s.jsx)("span",{className:"uppercase font-mono",children:"All buckets"}),"data-sentry-element":"unknown","data-sentry-source-file":"StorageMenu.tsx"}),M&&(0,s.jsxs)("div",{className:"space-y-2 mx-2",children:[(0,s.jsx)(Y.A,{className:"!py-2.5"}),(0,s.jsx)(Y.A,{className:"!py-2.5"}),(0,s.jsx)(Y.A,{className:"!py-2.5"})]}),B&&(0,s.jsx)("div",{className:"px-2",children:(0,s.jsxs)(Z.Fc,{variant:F?"default":"warning",children:[(0,s.jsx)(Z.XL,{className:"text-xs tracking-normal",children:F?"Storage is not available on preview branches for now":"Failed to fetch buckets"}),(0,s.jsx)(Z.TN,{className:"text-xs",children:F?"We're actively looking into making this available on preview branches":"Please refresh to try again"})]})}),T&&(0,s.jsxs)(s.Fragment,{children:[0===z.length&&(0,s.jsx)(ee.Q5,{className:"mx-2",title:"No buckets available",description:"Buckets that you create will appear here"}),c.length>0&&0===I.length&&(0,s.jsx)(ee.Q5,{className:"mx-2",title:"No results found",description:'Your search for "'.concat(c,'" did not return any results')}),I.map((e,l)=>{let i=a===e.id;return(0,s.jsx)(eo,{bucket:e,projectRef:t,isSelected:i,onSelectEmptyBucket:()=>_(e),onSelectDeleteBucket:()=>w(e),onSelectEditBucket:()=>g(e)},"".concat(l,"_").concat(e.id))})]})]}),(0,s.jsx)("div",{className:"h-px w-full bg-border"}),(0,s.jsxs)("div",{className:"mx-3",children:[(0,s.jsx)(X.Ay.Group,{title:(0,s.jsx)("span",{className:"uppercase font-mono",children:"Configuration"}),"data-sentry-element":"unknown","data-sentry-source-file":"StorageMenu.tsx"}),(0,s.jsx)(b(),{href:"/project/".concat(t,"/storage/policies"),"data-sentry-element":"Link","data-sentry-source-file":"StorageMenu.tsx",children:(0,s.jsx)(X.Ay.Item,{rounded:!0,active:"policies"===C,"data-sentry-element":"unknown","data-sentry-source-file":"StorageMenu.tsx",children:(0,s.jsx)("p",{className:"truncate",children:"Policies"})})}),(0,s.jsx)(b(),{href:"/project/".concat(t,"/settings/storage"),"data-sentry-element":"Link","data-sentry-source-file":"StorageMenu.tsx",children:(0,s.jsx)(X.Ay.Item,{rounded:!0,"data-sentry-element":"unknown","data-sentry-source-file":"StorageMenu.tsx",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("p",{className:"truncate",children:"Settings"}),(0,s.jsx)(f.A,{strokeWidth:1,className:"h-4 w-4","data-sentry-element":"ArrowUpRight","data-sentry-source-file":"StorageMenu.tsx"})]})})})]})]})]}),(0,s.jsx)(P,{visible:u,onClose:()=>m(!1),"data-sentry-element":"CreateBucketModal","data-sentry-source-file":"StorageMenu.tsx"}),(0,s.jsx)(D,{visible:void 0!==y,bucket:y,onClose:()=>g(void 0),"data-sentry-element":"EditBucketModal","data-sentry-source-file":"StorageMenu.tsx"}),(0,s.jsx)($,{visible:void 0!==v,bucket:v,onClose:()=>_(void 0),"data-sentry-element":"EmptyBucketModal","data-sentry-source-file":"StorageMenu.tsx"}),(0,s.jsx)(G.vd,{visible:void 0!==k,bucket:k,onClose:()=>w(void 0),"data-sentry-element":"DeleteBucketModal","data-sentry-source-file":"StorageMenu.tsx"})]})},ed=(0,c.r)(e=>{var t;let{title:a,children:c}=e,{ref:p}=(0,l.g)(),h=(0,o.KT)(),x=(0,u.W)(),{data:f,isLoading:y}=(0,r.Gm)({projectRef:p}),b=null==f||null==(t=f.app_config)?void 0:t.endpoint,{serviceKey:j}=(0,r.d6)(f),g=(null==h?void 0:h.status)===d.BU.INACTIVE;(0,i.useEffect)(()=>{!y&&b&&(null==j?void 0:j.api_key)&&v(b,j.api_key)},[y,p,b,null==j?void 0:j.api_key]);let v=async(e,t)=>{if(!g)if(e){var a,s;let l=null!=(s=null==f||null==(a=f.app_config)?void 0:a.protocol)?s:"https";x.initStore(p,e,t,l)}else n.oR.error("Failed to fetch project configuration. Try refreshing your browser, or reach out to us at support@supabase.io")};return(0,s.jsx)(m.A,{title:a||"Storage",product:"Storage",productMenu:(0,s.jsx)(ec,{}),"data-sentry-element":"ProjectLayout","data-sentry-component":"StorageLayout","data-sentry-source-file":"StorageLayout.tsx",children:c})})},69763:(e,t,a)=>{a.d(t,{F:()=>m});var s=a(80263),l=a(53239),i=a(77690),n=a(89977),r=a(10860),o=a(61645),c=a(89714),d=a(23278);let u={danger:(0,s.jsx)(n.A,{strokeWidth:1.5,size:18}),success:(0,s.jsx)(r.A,{strokeWidth:1.5,size:18}),warning:(0,s.jsx)(o.A,{strokeWidth:1.5,size:18}),info:(0,s.jsx)(c.A,{strokeWidth:1.5,size:18}),neutral:(0,s.jsx)(s.Fragment,{})};function m(e){let{variant:t="neutral",className:a,title:n,withIcon:r,closable:o,children:c,icon:m,actions:p}=e,h=(0,i.A)("alert"),[x,f]=(0,l.useState)(!0),y=[h.base];y.push(h.variant[t].base),a&&y.push(a);let b=[h.description,h.variant[t].description],j=[h.close];return(0,s.jsx)(s.Fragment,{children:x&&(0,s.jsxs)("div",{className:y.join(" "),children:[r?(0,s.jsx)("div",{className:h.variant[t].icon,children:r&&u[t]}):null,m&&m,(0,s.jsxs)("div",{className:"flex flex-1 items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:[h.variant[t].header,h.header].join(" "),children:n}),(0,s.jsx)("div",{className:b.join(" "),children:c})]}),p]}),o&&(0,s.jsx)("button",{"aria-label":"Close alert",onClick:()=>f(!1),className:j.join(" "),children:(0,s.jsx)(d.A,{strokeWidth:2,size:16})})]})})}},70639:(e,t,a)=>{a.d(t,{Ay:()=>r});var s=a(80263),l=a(90709);a(53239);var i=a(77690);let n=e=>{let{open:t,children:a,className:i,...n}=e;return(0,s.jsx)(l.bL,{asChild:n.asChild,defaultOpen:n.defaultOpen,open:t,onOpenChange:n.onOpenChange,disabled:n.disabled,className:i,"data-sentry-element":"unknown","data-sentry-component":"Collapsible","data-sentry-source-file":"Collapsible.tsx",children:a})};n.Trigger=function(e){let{children:t,asChild:a}=e;return(0,s.jsx)(l.l9,{asChild:a,"data-sentry-element":"unknown","data-sentry-component":"Trigger","data-sentry-source-file":"Collapsible.tsx",children:t})},n.Content=function(e){let{asChild:t,children:a,className:n}=e,r=(0,i.A)("collapsible");return(0,s.jsx)(l.UC,{asChild:t,className:[r.content,n].join(" "),"data-sentry-element":"unknown","data-sentry-component":"Content","data-sentry-source-file":"Collapsible.tsx",children:a})};let r=n},89977:(e,t,a)=>{a.d(t,{A:()=>s});let s=(0,a(47370).A)("OctagonAlert",[["path",{d:"M12 16h.01",key:"1drbdi"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M15.312 2a2 2 0 0 1 1.414.586l4.688 4.688A2 2 0 0 1 22 8.688v6.624a2 2 0 0 1-.586 1.414l-4.688 4.688a2 2 0 0 1-1.414.586H8.688a2 2 0 0 1-1.414-.586l-4.688-4.688A2 2 0 0 1 2 15.312V8.688a2 2 0 0 1 .586-1.414l4.688-4.688A2 2 0 0 1 8.688 2z",key:"1fd625"}]])}}]);